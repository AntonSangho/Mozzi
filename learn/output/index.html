
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>output - MOZZI</title>
  <meta name="author" content="Tim Barrass">
  
  
  <meta name="description" content="Mozzi is a sound synthesis software library for Arduino." />

  
  <meta name="keywords" content="Applications : sound, music, audio, synthesis, synthesiser, synthesizer, sound art, electronic music, computer music, generative music, sonification, media art, performance, installation, electronic art, creative art, interactive art, Software: library, arduino, open source, extendable, free, Audience: artists, scientists, teachers, learners, students, hobby, do it yourself, diy, makers, creators, musicians, engineers, collaborators" />

  <!-- https://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://sensorium.github.io/Mozzi//learn/output">
  <link href="/Mozzi/favicon.png" rel="icon">
  <link href="/Mozzi/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/Mozzi/atom.xml" rel="alternate" title="MOZZI" type="application/atom+xml">
  <script src="/Mozzi/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/Mozzi/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at https://google.com/webfonts -->

<link href='https://fonts.googleapis.com/css?family=Londrina+Solid&text=MOZZI' rel='stylesheet' type='text/css'>


  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-32577259-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'https://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner">
<div id="header_wrap">
	
	<hgroup>
		<h1 id="banner_main_title"><a href="/Mozzi/">MOZZI</a></h1>
		
		
			<h2>sound synthesis library for Arduino</h2>
		
	</hgroup>
	
	<img src="/Mozzi/images/mozzi-circle.gif" id="mozzi_logo"/> 
	<img src="/Mozzi/images/lee.gif" id="lee"/>

	<section id="header_links_section">
		<p>
			<a  class="header_link" href="https://github.com/sensorium/Mozzi"> 
				<span id="header_small_label">View on <i class="icon-github icon-2x"></i> GitHub</span>
			</a>
		</p>
		<p>
		
			<a class="header_link" href="/Mozzi/donate">
			<!-- <a class="header_link" href="https://github.com/sensorium/Mozzi/releases">  -->
			<!-- <a class="header_link" href="https://tinyurl.com/mozzilib/Mozzi.zip" >  --> <!--download="Mozzi.zip" > stops download working in chrome -->
			<!-- <a class="header_link" href="/Mozzi/download/">  -->
				download<br>
				<i class="icon-download icon-4x"></i><br>
				<span id="header_small_label">version v1.0.3rc6</span>
			</a>
		</p>
	</section> 

</div>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/Mozzi/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <!-- <input type="hidden" name="q" value="site:sensorium.github.io/Mozzi/" /> -->
    <input type="hidden" name="q" value="https://sensorium.github.io/Mozzi/" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/Mozzi/">Home</a></li>
  <li><a href="/Mozzi/examples/">Examples</a></li>
  <li><a href="/Mozzi/learn/">Learn</a></li>
  <li><a href="/Mozzi/gallery/">Gallery</a></li>
  <li><a href="/Mozzi/faq/">FAQ</a></li>
  <li><a href="https://groups.google.com/forum/#!forum/mozzi-users/">Forum</a></li>
  <li><a href="/Mozzi/doc/html/index.html">API</a></li>
  <!-- <li><a href="/Mozzi/consulting/">Consulting</a></li> -->
  <!-- <li><a href="https://mozzi.sharetribe.com/">Market</a></li> -->
  <!-- <li><a href="/Mozzi/download/">Download</a></li> -->
  <!-- <li><a href="/Mozzi/blog/">Blog</a></li> -->
  <!-- <li><a href="/Mozzi/resources/">Resources</a></li>   -->
  <!-- <li><a href="/Mozzi/blog/archives/">Archives</a></li>
  <li><a href="/Mozzi/about/">About</a></li> -->
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article role="article">
  
  <header>
    <h1 class="entry-title">Output</h1>
    
  </header>
  
  <p>The default AUDIO_MODE since March 2014 is STANDARD_PLUS.  On Atmel-based boards this mode has a pwm carrier rate of 32768 Hz, double the rate for STANDARD mode.
The higher pwm rate is above hearing range, an advance on STANDARD mode&#8217;s 16384 Hz which can be audible for children and some adults.<br/>
Teensy 3.1 boards provide true analog DAC rather than pwm, so Teensy 3.1 is a great option for cleaner sounding audio and you won&#8217;t need a pwm carrier filter. Teensy 3.1 also runs much faster than the Atmel based Arduinos, so you can generate more complex sounds.<br/>
STANDARD_PLUS can still benefit from a low pass filter, as outlined below for STANDARD mode.</p>

<h2>Output circuit for HIFI mode</h2>

<p>Mozzi&#8217;s HIFI audio mode combines the output of 2 pins in a technique called dual PWM, which is explained in detail at <a href="http://www.openmusiclabs.com/learning/digital/pwm-dac/dual-pwm-circuits/">Open Music Labs</a>.</p>

<p>Here&#8217;s the circuit for Mozzi, based on the Open Music Labs article.</p>

<p><img src="https://farm8.staticflickr.com/7458/10657009473_26c1f478de.jpg" alt="Mozzi output circuit for HIFI audio mode" /></p>

<p>Teensy 3.1 doesn&#8217;t use 14 bit pwm HIFI mode, but has 12 bit DAC analog output enabled by default, even in STANDARD and STANDARD_PLUS modes.</p>

<h4>Advantages of HIFI mode</h4>

<ul>
<li>Higher resolution sound than STANDARD or STANDARD_PLUS modes.</li>
<li>Doesn&#8217;t need a notch filter on the audio signal because the carrier frequency is out of hearing range (STANDARD_PLUS also doesn&#8217;t need it).</li>
</ul>


<h4>Disadvantages</h4>

<ul>
<li>Requires 2 pins, 2 resistors and a capacitor, so it&#8217;s not so quick to set up compared to a rough, direct single-pin output in STANDARD mode.</li>
</ul>


<h3>Pins and where to put the resistors on various boards for HIFI mode</h3>

<p>Boards tested in HIFI mode have an x, though most of these have been tested in STANDARD mode
and there&#8217;s no reason for them not to work in HIFI (unless the pin number is wrong or something).
Any reports are welcome.</p>

<p>resistor&#8230;..3.9k&#8230;&#8230;499k (or 2 1M in parallel)<br/>
x&#8230;&#8230;&#8230;&#8230;&#8230;.9&#8230;&#8230;&#8230;.10&#8230;&#8230;&#8230;&#8230;&#8230;Arduino Uno<br/>
x&#8230;&#8230;&#8230;&#8230;&#8230;.9&#8230;&#8230;&#8230;.10&#8230;&#8230;&#8230;&#8230;&#8230;Arduino Duemilanove<br/>
x&#8230;&#8230;&#8230;&#8230;&#8230;.9&#8230;&#8230;&#8230;.10&#8230;&#8230;&#8230;&#8230;&#8230;Arduino Nano<br/>
&#8230;&#8230;&#8230;&#8230;&#8230;&#8230;9&#8230;&#8230;&#8230;.10&#8230;&#8230;&#8230;&#8230;&#8230;Arduino Leonardo<br/>
x&#8230;&#8230;&#8230;&#8230;&#8230;.9&#8230;&#8230;&#8230;.10&#8230;&#8230;&#8230;&#8230;&#8230;Ardweeny<br/>
x&#8230;&#8230;&#8230;&#8230;&#8230;.9&#8230;&#8230;&#8230;.10&#8230;&#8230;&#8230;&#8230;&#8230;Boarduino<br/>
x&#8230;&#8230;&#8230;&#8230;&#8230;.11&#8230;&#8230;&#8230;12&#8230;&#8230;&#8230;&#8230;&#8230;Freetronics EtherMega<br/>
&#8230;&#8230;&#8230;&#8230;&#8230;..11&#8230;&#8230;&#8230;12&#8230;&#8230;&#8230;&#8230;&#8230;Arduino Mega<br/>
&#8230;&#8230;&#8230;&#8230;&#8230;..14&#8230;&#8230;&#8230;15&#8230;&#8230;&#8230;&#8230;..Teensy<br/>
&#8230;&#8230;&#8230;&#8230;&#8230;B5(14)&#8230;B6(15)&#8230;&#8230;&#8230;Teensy2<br/>
x&#8230;&#8230;&#8230;&#8230;.B5(25)&#8230;B6(26)&#8230;&#8230;&#8230;Teensy2++<br/>
&#8230;&#8230;&#8230;&#8230;&#8230;..13&#8230;&#8230;&#8230;12&#8230;&#8230;&#8230;&#8230;&#8230;Sanguino</p>

<h3>Low pass audio filter</h3>

<p>Mozzi&#8217;s sound output can be filtered to reduce aliasing at high frequencies.
Here&#8217;s some info about low pass <a href="http://electronics.stackexchange.com/questions/34843/how-determine-the-rc-time-constant-in-pwm-digital-to-analog-low-pass-filter">RC filters</a> and a <a href="http://sim.okawa-denshi.jp/en/PWMtool.php">calculator</a> to help choose components.
For Mozzi, an RC filter with a roll-off frequency of just under 6kHz works well, using a 270 Î© resistor and a 100n capacitor, as shown below.   In HIFI mode, this would be on the combined audio output signal rather than straight from pin 9.</p>

<p><img src="http://farm9.staticflickr.com/8317/7934584004_096300ef0d.jpg" alt="RC circuit" /></p>

<h3>Notch filter for STANDARD mode carrier frequency</h3>

<p>This may still be useful if you need to use STANDARD mode for some reason, for instance if you need Timer 2 for another process
(making HIFI unavailable), or if your sketch is too intensive for STANDARD_PLUS and you need 10% more juice.</p>

<p>People who have used Mozzi in STANDARD mode with children report that kids find the carrier frequency particularly irritating, however adults are often unable to perceive it at any level!  Many thanks to Andrew McPherson, who sent a schematic and equation for a twin-T notch filter which he used successfully to remove the offending frequency.</p>

<p><img src="http://farm9.staticflickr.com/8470/8124196839_6f3e506525.jpg" alt="Twin-T Notch Filter" />
<img src="http://farm9.staticflickr.com/8472/8124196815_6c02f4fb86.jpg" alt="equation" /></p>

<p>Here&#8217;s a design tool for calculating <a href="http://sim.okawa-denshi.jp/en/TwinTCRtool.php">Twin-T notch filters.</a></p>

<p>Andrew also reported that the low-pass and notch filter described here can be used together in series without any problems.</p>

<p>Here&#8217;s a schematic for the 6kHz low pass and the notch filter using commonly available parts chosen to exactly match STANDARD mode&#8217;s 16384Hz carrier frequency, using the notch filter design tool.</p>

<p><img src="http://farm9.staticflickr.com/8209/8210496070_4a1b21f8c1_c.jpg" alt="Schematic" /></p>

<h3>Download</h3>

<p>Download a Fritzing file with breadboard, schematic and circuit board layouts <a href="https://docs.google.com/file/d/0B_eOzePFYDZaSEo4bVJ6NlJnSXM/edit?usp=sharing">here</a>.</p>

  
    <footer>
      
      
        <div class="sharing">
  
  <a href="/Mozzi//twitter.com/share" class="twitter-share-button" data-url="http://sensorium.github.io/Mozzi//learn/output/index.html" data-via="nothingperson" data-counturl="http://sensorium.github.io/Mozzi//learn/output/index.html" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

      
    </footer>
  
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/Mozzi/blog/2018/02/05/mozzibyte-synth-shield-kickstarter-launched/">MozziByte Synth Shield Kickstarter Launched</a>
      </li>
    
      <li class="post">
        <a href="/Mozzi/blog/2017/04/04/v1-dot-0-3rc6-hifi-works/">v1.0.3rc6 HIFI Works</a>
      </li>
    
      <li class="post">
        <a href="/Mozzi/blog/2017/03/12/v1-dot-0-3rc5-hifi-compile-fix/">v1.0.3rc5 HIFI Compile Fix</a>
      </li>
    
      <li class="post">
        <a href="/Mozzi/blog/2017/01/16/v1-dot-0-3rc4-fixes-compile/">v1.0.3rc4 Fixes Compile</a>
      </li>
    
      <li class="post">
        <a href="/Mozzi/blog/2016/12/11/v1-dot-0-3rc2-teensy-bugfix/">v1.0.3rc2 Teensy Bugfix</a>
      </li>
    
  </ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br /><span xmlns:dct="https://purl.org/dc/terms/" property="dct:title">Mozzi</span> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/sensorium/Mozzi" property="cc:attributionName" rel="cc:attributionURL">Tim Barrass</a> is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
</br>
  <!-- Copyright &copy; 2018 - Tim Barrass - -->
  <span class="credit">Powered by <a href="https://octopress.org">Octopress</a></span>
  <span class="credit">Published with <a href="https://pages.github.com">GitHub Pages</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
